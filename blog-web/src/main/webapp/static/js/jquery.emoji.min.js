(function (a, p, q) {
    function n(b, h) {
        this.$content = a(b);
        this.options = h;
        this.index = emoji_index;
        switch (h.animation) {
            case "none":
                this.showFunc = "show";
                this.hideFunc = "hide";
                this.toggleFunc = "toggle";
                break;
            case "slide":
                this.showFunc = "slideDown";
                this.hideFunc = "slideUp";
                this.toggleFunc = "slideToggle";
                break;
            case "fade":
                this.showFunc = "fadeIn";
                this.hideFunc = "fadeOut";
                this.toggleFunc = "fadeToggle";
                break;
            default:
                this.showFunc = "fadeIn", this.hideFunc = "fadeOut", this.toggleFunc = "fadeToggle"
        }
        this._init()
    }

    var r = {
        showTab: !0,
        animation: "fade", icons: []
    };
    p.emoji_index = 0;
    n.prototype = {
        _init: function () {
            var b = this, h = this.options.button, c, d, g, f, e = b.index;
            h || (c = '<input type="image" class="emoji_btn" id="emoji_btn_' + e + '" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZBAMAAAA2x5hQAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAkUExURUxpcfTGAPTGAPTGAPTGAPTGAPTGAPTGAPTGAPTGAPTGAPTGAOfx6yUAAAALdFJOUwAzbVQOoYrzwdwkAoU+0gAAAM1JREFUGNN9kK0PQWEUxl8fM24iCYopwi0muuVuzGyKwATFZpJIU01RUG/RBMnHxfz+Oef9uNM84d1+23nO+zxHKVG2WWupRJkdcAwtpCK0lpbqWE01pB0QayonREMoIp7AawQrWSgGGb4pn6dSeSh68FAVXqHqy3wKrkJiDGDTg3dnp//w+WnwlwIOJauF+C7sXRVfdha4O4oIJfTbtdSxs2uqhs585A0ko8iLTMEcDE1n65A+29pYAlr72nz9dKu7GuNTcsL2fDQzB/wCPVJ69nZGb3gAAAAASUVORK5CYII="/>',
                d = this.$content.offset().top + this.$content.outerHeight() + 10, g = this.$content.offset().left + 2, a(c).appendTo(a("body")), a("#emoji_btn_" + e).css({
                top: d + "px",
                left: g + "px"
            }), h = "#emoji_btn_" + e);
            var l = this.options.showTab;
            d = this.options.basePath;
            g = this.options.icons;
            c = g.length;
            if (0 === c) return console.error("\u8868\u60c5\u56fe\u8def\u5f84\u8bfb\u53d6\u5931\u8d25"), !1;
            for (var n = '<div class="emoji_container" id="emoji_container_' + e + '">', B = '<div class="emoji_content">', l = '<div class="emoji_tab" style="' + (1 !== c ||
            l ? "" : "display:none;") + '"><div class="emoji_tab_prev"></div><div class="emoji_tab_list"><ul>', v, p, y, t, w, r, A, m, x, z, k = 0; k < c; k++) if (p = g[k].name || "group" + (k + 1), y = d + "/" + g[k].path, t = g[k].maxNum, w = g[k].excludeNums, r = g[k].file || ".jpg", A = g[k].placeholder || "#em" + (k + 1) + "_{alias}#", m = g[k].emoji, x = 0, y) {
                v = '<div id="emoji' + k + '" class="emoji_icons" style="' + (0 === k ? "" : "display:none;") + '"><ul>';
                if (m) {
                    if ("object" !== typeof m) {
                        console.error("\u7b2c " + k + " \u7ec4 emoji \u53c2\u6570\u8bbe\u7f6e\u4e0d\u6b63\u786e");
                        break
                    }
                    t =
                        t || m.length;
                    for (f in m) x++, x > t || w && 0 <= w.indexOf(x) || (z = A.replace(/{alias}/gi, f.toString()), v += '<li><a data-emoji_code="' + z + '" data-index="' + x + '" title="' + f + '"><img src="' + y + m[f] + r + '"/></a></li>')
                } else {
                    if (!t) {
                        console.error("\u8bf7\u6307\u5b9a " + k + " \u7ec4\u8868\u60c5 maxNum");
                        continue
                    }
                    for (m = 1; m <= t; m++) w && 0 <= w.indexOf(m) || (z = A.replace(/{alias}/gi, m.toString()), v += '<li><a data-emoji_code="' + z + '" data-index="' + m + '"><img src="' + y + m + r + '"/></a></li>')
                }
                v += "</ul></div>";
                B += v;
                l += '<li data-emoji_tab="emoji' +
                    k + '" class="' + (0 === k ? "selected" : "") + '" title="' + p + '">' + p + "</li>"
            } else console.error("\u7b2c " + k + " \u7ec4\u8868\u60c5\u672a\u914d\u7f6e\u56fe\u7247\u8def\u5f84 path");
            n = n + (B + "</div>") + (l + '</ul></div><div class="emoji_tab_next"></div></div>') + '<div class="emoji_preview"><img/></div>';
            a(n).appendTo(a("body"));
            f = a(h).offset().top + a(h).outerHeight() + 5;
            d = a(h).offset().left;
            a("#emoji_container_" + e).css({top: f + "px", left: d + "px"});
            var C = 0 === c % 8 ? parseInt(c / 8) : parseInt(c / 8) + 1, u = 1;
            a(q).on({
                click: function (d) {
                    var c =
                        d.target;
                    d = b.$content[0];
                    var f, g;
                    if (c === a(h)[0]) a("#emoji_container_" + e)[b.toggleFunc](); else 0 < a(c).parents("#emoji_container_" + e).length ? (f = a(c).data("emoji_code") || a(c).parent().data("emoji_code"), g = a(c).data("emoji_tab"), f ? ("DIV" === d.nodeName ? (c = a("#emoji_container_" + e + ' a[data-emoji_code="' + f + '"] img').attr("src"), b._insertAtCursor(d, '<img class="emoji_icon" src="' + c + '"/>', !1)) : b._insertAtCursor(d, f), b.hide(), b.$content.focus()) : g ? a(c).hasClass("selected") || (a("#emoji_container_" + e + " .emoji_icons").hide(),
                        a("#emoji_container_" + e + " #" + g).show(), a(c).addClass("selected").siblings().removeClass("selected")) : a(c).hasClass("emoji_tab_prev") ? 1 < u && (a("#emoji_container_" + e + " .emoji_tab_list ul").css("margin-left", -503 * (u - 2) + "px"), u--) : a(c).hasClass("emoji_tab_next") && u < C && (a("#emoji_container_" + e + " .emoji_tab_list ul").css("margin-left", -503 * u + "px"), u++)) : 0 < a("#emoji_container_" + e + ":visible").length && (b.hide(), b.$content.focus())
                }
            });
            a("#emoji_container_" + e + " .emoji_icons a").mouseenter(function () {
                2 * (a(this).offset().left -
                    a("#emoji_container_" + e).offset().left) < a("#emoji_container_" + e).width() ? a("#emoji_container_" + e + " .emoji_preview").css({
                    left: "auto",
                    right: 0
                }) : a("#emoji_container_" + e + " .emoji_preview").css({left: 0, right: "auto"});
                var b = a(this).find("img").attr("src");
                a("#emoji_container_" + e + " .emoji_preview img").attr("src", b).parent().show()
            });
            a("#emoji_container_" + e + " .emoji_icons a").mouseleave(function () {
                a("#emoji_container_" + e + " .emoji_preview img").removeAttr("src").parent().hide()
            })
        }, _insertAtCursor: function (b,
                                      a, c) {
            var d;
            if ("DIV" === b.nodeName) if (b.focus(), p.getSelection) {
                if (d = p.getSelection(), d.getRangeAt && d.rangeCount) {
                    b = d.getRangeAt(0);
                    b.deleteContents();
                    var g = q.createElement("div");
                    g.innerHTML = a;
                    a = q.createDocumentFragment();
                    for (var f, e; f = g.firstChild;) e = a.appendChild(f);
                    g = a.firstChild;
                    b.insertNode(a);
                    e && (b = b.cloneRange(), b.setStartAfter(e), c ? b.setStartBefore(g) : b.collapse(!0), d.removeAllRanges(), d.addRange(b))
                }
            } else (d = q.selection) && "Control" !== d.type && (a = d.createRange(), a.collapse(!0), d.createRange().pasteHTML(html),
            c && (b = d.createRange(), b.setEndPoint("StartToStart", a), b.select())); else q.selection ? (b.focus(), d = q.selection.createRange(), d.text = a, d.select()) : b.selectionStart || 0 === b.selectionStart ? (c = b.selectionStart, d = b.selectionEnd, e = b.scrollTop, b.value = b.value.substring(0, c) + a + b.value.substring(d, b.value.length), 0 < e && (b.scrollTop = e), b.focus(), b.selectionStart = c + a.length, b.selectionEnd = c + a.length) : (b.value += a, b.focus())
        }, show: function () {
            a("#emoji_container_" + this.index)[this.showFunc]()
        }, hide: function () {
            a("#emoji_container_" +
                this.index)[this.hideFunc]()
        }, toggle: function () {
            a("#emoji_container_" + this.index)[this.toggleFunc]()
        }
    };
    a.fn.emoji = function (b) {
        emoji_index++;
        return this.each(function () {
            var h = a(this), c = h.data("plugin_emoji" + emoji_index),
                d = a.extend({}, r, h.data(), "object" === typeof b && b);
            c || h.data("plugin_emoji" + emoji_index, c = new n(this, d));
            if ("string" === typeof b) c[b]()
        })
    };
    a.fn.emoji.Constructor = n
})(jQuery, window, document);
(function (a, p, q) {
    function n(b, h) {
        this.$content = a(b);
        this.options = h;
        this._init()
    }

    var r = {icons: []};
    n.prototype = {
        _init: function () {
            var a = this.options.icons, h = this.options.basePath, c = a.length, d, g, f, e;
            if (0 < c) for (var l = 0; l < c; l++) if (d = h + "/" + a[l].path, g = a[l].file || ".jpg", f = a[l].placeholder, f = f.replace("[", "\\["), f = f.replace("]", "\\]"), f = f.replace("(", "\\("), f = f.replace(")", "\\)"), e = a[l].emoji, d) if (e) {
                if ("object" !== typeof e) {
                    console.error("\u7b2c " + l + " \u7ec4 emoji \u53c2\u6570\u8bbe\u7f6e\u4e0d\u6b63\u786e");
                    break
                }
                f = f.replace(/{alias}/gi, "([\\s\\S]+?)");
                f = new RegExp(f, "gm");
                this.$content.html(this.$content.html().replace(f, function (a, b) {
                    var c = e[b];
                    return c ? '<img class="wp-smiley" src="' + d + c + g + '" title="' + b + '" alt="' + b + '"/>' : a
                }))
            } else f = f.replace(/{alias}/gi, "(\\d+?)"), this.$content.html(this.$content.html().replace(new RegExp(f, "gm"), '<img class="wp-smiley" src="' + d + "$1" + g + '"/>')); else console.error("\u7b2c " + l + " \u7ec4\u8868\u60c5\u672a\u914d\u7f6e\u56fe\u7247\u8def\u5f84 path")
        }
    };
    a.fn.emojiParse = function (b) {
        return this.each(function () {
            var h =
                a(this), c = h.data("plugin_emojiParse"), d = a.extend({}, r, h.data(), "object" === typeof b && b);
            c || h.data("plugin_emojiParse", c = new n(this, d));
            if ("string" === typeof b) c[b]()
        })
    };
    a.fn.emojiParse.Constructor = n
})(jQuery, window, document);